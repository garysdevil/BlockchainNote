---
title: 区块链的扩容
created_date: 2023-11-01
---

[TOC]

## 链接

- 参考 https://www.8btc.com/article/6790168

## 扩容

- 链上扩容： 通过改变一层主网协议达到扩容效果的解决方案。
- 链下扩容： 不改变现有一层主网协议的扩容解决方案。

## 链上扩容

1. 方案一： 扩大区块空间，即增加每个区块打包的交易数量，但这会提高对高性能节点设备的要求，提高节点的加入门槛，降低了「去中心化」程度。
2. 方案二： 分片，将区块链账本分成若干部分，不再是每个节点参与所有记账，而是由不同分片即不同节点负责不同记账，并行计算可以同时处理多个交易；这样可降低节点计算压力和加入门槛，提高交易处理速度和去中心化程度；但这意味着全网算力被分散，会降低整个网络的「安全性」。

## 链下扩容_Layer2

- L2是一系列链下扩容方案的总称，位于（并依赖于）L1网络之上，通过将交易放在L1网络之外进行处理，将交易的执行和资产结算分离，同时继承主网的共识和强大的去中心化和安全性，最后将数据可用性Data Availability（取决于不同L2的解决方案）和最终结算的状态上链。

### State Channel

- 状态通道(State Channel)： 利用多签智能合约，先将一定量的资金存入智能合约里，支持用户在链下进行无数次的免费交易，最后在主网进行最终结算。

- 状态通道规定只有在通道打开、关闭或解决纠纷时，用户才需要与主网进行交互，并把用户与用户的交互放在链下进行，以此来降低用户交易的时间和金钱成本，并且实现交易次数不受限制。

- 相关项目：Rainden、Celer。（闪电网络 利用的技术就是 状态通道）

### Rollup

- Rollup： 在主网外执行交易（计算过程和状态存储），然后将原始数据压缩后发布到主网。
  - 优点： 通过仅仅在链上存储交易数据，从而减少目前存在的网络拥堵问题，提升速度，尽可能的降低Gas费用。

### Optimistic Rollup

- 原理： 通过提出欺诈证明，确保链下状态的正确性。

- 优点：有验证、交易数据完整性、数据压缩性。返回给Layer1的有交易结果和交易的信息，这些数据被压缩后返回给Layer1。

- 缺点：提款到链上需要等待一定的周期。

- 相关项目

  1. Arbitrum
  2. Optimism
     1. 代币 OP
     2. 与以太坊虚拟机（EVM）等效的Optimism虚拟机（OVM）.
     3. 2021年12月，Optimism主网正式上线。
  3. Metis Andromeda
     1. 分叉自Optimism
  4. Boba Network
     1. 分叉自Optimism，支持快速提款
     2. 2021年9月，Boba主网公开上线。
     3. Boba的特点是，借由一部分用户通过质押代币提供的流动性池，允许用户快速提款，而不必等待7天左右的反欺诈期结束。相应地，选择快速提款的用户需要向提供流动性的用户缴纳一定的费用

### ZK Rollup

- 原理： 通过上传零知识证明，确保链下状态的正确性。

- ZK Rollup 是基于零知识证明的二层扩容方案(layer2)， ZK Rollup方案起源于18年下半年，由Barry Whitehat和Vitalik先后提出。Rollup顾名思义有“卷起”和“汇总”的意思，将大量的交易“卷起/汇总”打包成一个交易。原理为链下进行复杂的计算和证明的生成，链上进行证明的校验并存储部分数据保证数据可用性。

- 优点：有验证、匿名性、数据压缩性。

- 相关项目

  - zkSync
  - StarkNet
  - DEX Loopring
  - DEX dYdX
  - DEX zkSpace

- 主流的 ZK Rollup 如StarkWare等，主要包含两大核心角色

  1. Sequencer 排序器
     1. 负责执行 Layer2 网络内的交易，将这些交易事件排序，打包成Batch（交易批次）。
     2. 定期将 Batch 发布到Layer1上的指定智能合约（App State Smart Contract）.
     3. 耗时短，一台家用电脑，每秒可以生成4000笔交易。
  2. Prover（Aggregator） 证明者
     1. 监听读取 Batch ，为其生成一个 ZK Proof，发布到Layer1上的指定智能合约进行验证（Varifier Smart Contract）。
     2. 耗时长，一台家用电脑，生成一个 Proof 需要1.5～2s。

- 安全： 链下的每一次交易都需要提供零知识证明。

  1. Sequencer 每次将很多个交易打包成一个 Batch ，存储进 App State Smart Contract 。
  2. Prover 读取 Batch ，生成一个 ZK Proof ， 给予 Varifier Smart Contract 进行验证。
  3. 验证通过，链下的交易执行成功。

## 链下扩容_其它

- 安全性并不是来源于主网的链下扩容解决方案。

### Sidechains侧链

- 原理： 和主网并行独立运行的区块链，和主网通过双向桥进行通讯，通过改变区块参数和共识机制进行扩容。

- 特性： 有自己的验证者、共识计算，通过桥接和主链进行通讯和交易。

- 优点：减轻主网的负担。

- 缺点：侧链是独立运行的，如果侧链上出现问题，比如侧链节点作恶或遭到攻击，会导致侧链执行交易有误，也就导致返回给Layer1的结果也是错误的。侧链的安全性不够。

- 相关项目：POA，Loom，Skale Network，Ronin Network，xDai Chain。

### Plasma

- 原理： 一个独立运行的区块链，通过把Merkle Root发布到主网的方式与主网进行瞄定，通过欺诈证明，确保链下状态的正确性。

- Plasma是一种特殊的侧链。利用智能合约和默克尔树依附主链建立无数的子链。链外进行签名；需要结算时将一笔笔交易生成默克尔树根，将默克尔树根传进 Plasma 协议链上，...

- 优点：有验证。Plasma不是完全被托管的，它使用了欺诈性证明的退出机制，当检测到plasma链上出现错误时，用户可以安全的从plasma链上退出，因此plasma具有更高的安全性。

- 缺点：Plasma返回给Layer1的仅有交易结果、没有交易信息。侧链资产锁定期为7～14天才能提取到以太坊主链上。

- 相关项目：OMG Network，Polygon（Matic）

### Validium

- 与ZKRollup 类似，不同点在于交易数据（如状态变化）在链下。
- 相关项目： DeversiFi、ZKSwap（支付、交易平台）、Sorare（足球NFT游戏）和Immutable X（NFT 市场）

### Volition

- 给用户提供两种方案的选择，使用zkRollup或Validium。

## 以太坊

- 以太坊扩容方案分为两个基本类别
  - 一类是将以太坊网络的工作任务拆分给节点，也就是ETH2要实现的链上分片。
  - 一类是让用户把大部分交易都放在以太坊链下的Layer2协议里，通过打包汇总交易提交到以太坊网络。

## 项目与方案

1. Scroll提出了名为PipeZK的ZK加速解决方案，该方案可以在普通消费级硬件上将ZK Proof的生成过程提高接近200倍。如果未来再结合FPGA和ASIC等专用硬件，加速效果或将进一步提升。

2. Polygon的Hermez项目组提出了一个新的构想，Proof Of Efficiency（POE），主要思想为允许多个Prover无需许可的参与到ZK Proof生成过程，并让这些Prover节点展开竞争，最终的Proof奖励只会分配给第一个成功的节点。
